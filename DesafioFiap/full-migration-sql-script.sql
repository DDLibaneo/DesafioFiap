DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'DesafioFiap.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202011202329275_UsuarioNewsletter'
BEGIN
    CREATE TABLE [dbo].[AspNetRoles] (
        [Id] [nvarchar](128) NOT NULL,
        [Name] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetRoles] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [RoleNameIndex] ON [dbo].[AspNetRoles]([Name])
    CREATE TABLE [dbo].[AspNetUserRoles] (
        [UserId] [nvarchar](128) NOT NULL,
        [RoleId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserRoles]([UserId])
    CREATE INDEX [IX_RoleId] ON [dbo].[AspNetUserRoles]([RoleId])
    CREATE TABLE [dbo].[AspNetUsers] (
        [Id] [nvarchar](128) NOT NULL,
        [Email] [nvarchar](256),
        [EmailConfirmed] [bit] NOT NULL,
        [PasswordHash] [nvarchar](max),
        [SecurityStamp] [nvarchar](max),
        [PhoneNumber] [nvarchar](max),
        [PhoneNumberConfirmed] [bit] NOT NULL,
        [TwoFactorEnabled] [bit] NOT NULL,
        [LockoutEndDateUtc] [datetime],
        [LockoutEnabled] [bit] NOT NULL,
        [AccessFailedCount] [int] NOT NULL,
        [UserName] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUsers] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [UserNameIndex] ON [dbo].[AspNetUsers]([UserName])
    CREATE TABLE [dbo].[AspNetUserClaims] (
        [Id] [int] NOT NULL IDENTITY,
        [UserId] [nvarchar](128) NOT NULL,
        [ClaimType] [nvarchar](max),
        [ClaimValue] [nvarchar](max),
        CONSTRAINT [PK_dbo.AspNetUserClaims] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserClaims]([UserId])
    CREATE TABLE [dbo].[AspNetUserLogins] (
        [LoginProvider] [nvarchar](128) NOT NULL,
        [ProviderKey] [nvarchar](128) NOT NULL,
        [UserId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey], [UserId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserLogins]([UserId])
    CREATE TABLE [dbo].[UsuarioNewsletter] (
        [Id] [int] NOT NULL IDENTITY,
        [Nome] [nvarchar](255) NOT NULL,
        [Email] [nvarchar](255) NOT NULL,
        CONSTRAINT [PK_dbo.UsuarioNewsletter] PRIMARY KEY ([Id])
    )
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[AspNetRoles] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserClaims] ADD CONSTRAINT [FK_dbo.AspNetUserClaims_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserLogins] ADD CONSTRAINT [FK_dbo.AspNetUserLogins_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011202329275_UsuarioNewsletter', N'DesafioFiap.Migrations.Configuration',  0x1F8B0800000000000400DD5C596FE4B8117E0F90FF20E82909BC2D1FF1606274EFC2DB762746C607A6ED45DE066C89DD264622B522E5B111EC2FCBC3FEA4FD0B21758B878E6EF5E1C100034B2C7E552C16C962A9AAFFF8DFEFE39F5E03DF7A811145044FEC93D1B16D41EC120FE1D5C48ED9F2878FF64F3FFEF94FE36B2F78B57EC9E9CE041DEF89E9C47E662CBC701CEA3EC300D05180DC8850B2642397040EF088737A7CFC0FE7E4C4811CC2E6589635FE1C638602983CF0C729C12E0C590CFC5BE2419F66EF79CB3C41B5EE400069085C38B1AF20054B44660884A394DAB62E7D04B82473E82F6D0B604C18605CCE8B270AE72C2278350FF90BE03FBE8590D32D814F6126FF4549DE7528C7A762284ED931877263CA48D013F0E42CD38D23775F4BC376A13BAEBD6BAE65F626469D687062DF783079F599F85C0132C38BA91F09E2897D5BB0B8A4E11D64A3BCE328859C451CEE1B89BE8EAA884756E77E47852D9D8E8EC5BF236B1AFB2C8EE004C39845C03FB21EE2858FDC7FC3B747F215E2C9D9C96279F6F1FC03F0CE3EFC1D9E9D5747CAC7CAE96A2FF8AB87888430E2B2C165317EDB72EAFD1CB963D1ADD227D50AB725BE2C6CEB16BC7E8278C59EF98239FD685B33F40ABDFC4D665C4F18F155C43BB128E68F77B1EF83850F8B76A791A7F8BF81EBE9F98741B8DE8117B44AA65EE2CF174EC4D7D567E827ADF41985E9F2AACDF7978C6C1691403CD7ED2B6DFD322771E48AC11023C923885690D5A51B3BA5F17632690135BC59E7A8876FDA4252D5BCB5A46240EBAC849CC5AE57432EEF76F976B6B8CB30E493979896D04893C1A987D548EA7D6455684AD339E96A3A980FE97BDE09AF0380FC01B6C20E5CB817B24451008B51FE4CB8E101DC5BE6074029DF09BC7F01FADC203AFF7300D1E7D08D236EA073068270EBDC1E9E09867771B01076BF3B5E834DCDE33732032E23D13516BD36C6FB44DCAF2466D7D8BB020C3E313707148F8F28E80E30883897AE0B299D716386DE9470273B07BCC1ECECB4379CD8A0F6ED8A4C7D8002BD2F226DA55F72D2D21FD153283E89814CE7973489FA89AC10EE266A4E6A1635A568153523EB2BAA00EB26694669163421689533A51ACCD34B666878572F813D7C5F6FB3C3DBB41754D438E73B24FC27C430E2DB98F7001883112E67A0CBBEB10F6721993EC174EB6753C2E917E0C743B35A6B35249BC0F0AB21813DFCD59088C95FBF204F78251D2E40393187EF44AFBF5BB5AF3949B25D2F87DA3077CD7C377B40E7E5F2446310217207BF511F8AEDACE7B54DE9FF3E2F6EDBDFFBEF488BBF78BE9F6BE2006C4DC67649297151A23D4D9C358B92D5C5E71706AB3D64968E460EBBF18171DB42C2BFE26FF842B265ABB9C757905B29B42EDD340E3D05D4059EAA453E20AF8760B9FBA611AC0CBFD585FB9BC2939B328C4427206EDC942F0E84996AF708BB28047EAB96A49E1DD78C187BC1436EB98221C48261AB26BA30D747DB8400051F6952DA3434762A16D76C88862B9269CEDBEE4BE5BC2B41B09DD864CB45CD6097D965612B86D9ACB11D1867B34ABA08608C1CEFC340B38B715703906FC98766A0D2F5DC60A099FFBE1303AD6B6C0F065A57C9BB33D0341ED275FEA5E0C8A199673D2AB3FB63BD515D7BB0CD9A3E0ECC3453DF93F761BC078C54F3BC5A8846F8CA34571B2E6776BBA199AB2B9B88009F43568F0F96FEAED60F759A4164236A022C0DAD0534FBE6AC00290BAA877079E0B851BACC8BE8019B07791B61B3BDBF75D4C9F59356EFAF0AACE68E2BC1564C4B15B9FA49BF4268FEF02FDB7CA74B4D31B2C2C894B5D3E90E52C1D1D899BC27D607DE4129A66F0BAA62BAB8D87D9CECCAC0B2C96850508B436C50523E98C1B5945B7CBB96747E5E1F4F6F232D495E99414BF96006D75266A3ED4AD2F81A3DBC8D8D5454F70C065A6C7900A538C48AB6B19366FA652FC68E2125707C0BC210E1552545307B63CDD3FCC0E90FF3FE8973418AE1B854933F57485B706224022B28B572D65CD2198A28BB020C2C80081F4DBD4021D31ED986ED3F67593D95D549CCCF819C5AFC9DF6D044326B47B8EAE36418333EC240384A49385033FFFAEE9648D9043E883411C829F1E3009BFD3673EFF41B74B57FFA4645183B92FC8A5FA6684BF19EEBAAEF3431EAA21868920AB768FD89324398D49D3BB555859B1C5D334A1EF7AAA29862617B9B389323D36BB264D7B3FF5CB5226C675D6551F32A40F6AA2746253F4701ABB47547ADA7505531EB2DDD11A53CA92AA4D4D443CA6A36544DC86AC35A78068DEA29BA7350F39FAAE86A6B77644D2654155AD3BC06B64666B9AD3BAA2659AA0AAC69EE8E5D664EC99BE8019F5CC69BCBDA47577A67DEECEC32606C67471CE6E8ABE4A154812AAF7B626599260A58F6FE20ADC978C35BDB9AD250C966D664C030EF3CB50C8EFAC6D3987662C6ACA565D436F7A6B414335E3F9BDD9BA3A504B036B40C35DAD5DF323A606CE94643941B0DD19F0B43F86E5B9D73E5522F9314DC8BCBBD74891F6717EAF6E23FE5869D92D856BE74B833F746190C46826034FFD59FFA088AA33B27B805182D216569128E7D7A7C722AD50F1E4E2D9F43A9E76B0212A682BEFA9CED209B08BF80C87D06919AD7B541BD5B09AA7CC5B8C11E7C9DD8FF4D7A5D24912BF157F2FAC8BAA14F18FD1AF386C72886D66F6A9EFA30A9641D2ACE0A417F7B17A55CDD557EF39F2F69D723EB3EE2CBE9C23A9614BDCEF4D70BBC7A499376DD409AB5CBBEDEEF6AAB25CB6951A5D5B27E09D502B141CAA77229FF1280D7BFF6154D5B22B511A2A60C6A28BC4154682A735A07CB58E2E4F147969438F51BACBEE4691DD18CE54E08F707938B9DBA6F4379CF3D9E439A4BF22EB6A444CFAD09C31B658EEFFB6C526A4A365AE86ADD480FB8416B43367351DE59CDC56047A7A6A46230EC7DDAFD067514DFC7A6532D5B30B844E75B71B4DA50B75E7470287506E5756ABFE505BBAC2868F8BCFB5D15121C40EAAB26956FFFE502BBB635D3F79803CFB9EE57147060C6963960FB4FFDDFB5B1993ED71CB8B1F54AF03F305BDBD7F9B9674BEB7C84EE3D5D5F4D1194A7559F4E9ECE5DE9096ADDB5F463C8C4F616841B41EA51A625FBFA444D13B3D2588C0C4B1233537386A8CC5859380A5F85A2996DBFB166077EE360339A66B686BCEA26DED9FEDFC83BA369E66DC85696796B6A0414DE1A1A1DEFC32C37D0262BEB2A4B5A36D1A64CCAF7545E501B494B914C9BC3DC98A1F39EAA0906514A6DE91A124DDE4FF1C0202A1972E9F4281650F307F8C15DF98961EE3C50B42A21C40F0E63E8D68EEC82E6062F49EE394812E5245298E71632E0F1F3FC326268095CC69BC57789E437289258AF88042DA07783EF6316C68C0F19060BBF1607151E4813FFA422A22EF3F83E144F748821703191F89E738F7F8E91EF1572CF3401290384706DB2809C984B260273ABB702E98EE08E4099FA0A8FEC1106A1CFC1E83D9E8317B88E6CDCFC3EC11570DFCAC0B009A47D22EA6A1F5F21B08A4040338CB23F7FE436EC05AF3FFE1FC79D0832695B0000 , N'6.4.4')
END

IF @CurrentMigration < '202011221655589_SeedAdminUser'
BEGIN
    
                    INSERT [dbo].[AspNetUsers] ([Id], [Email], [EmailConfirmed], [PasswordHash], [SecurityStamp], [PhoneNumber], [PhoneNumberConfirmed], [TwoFactorEnabled], [LockoutEndDateUtc], [LockoutEnabled], [AccessFailedCount], [UserName]) 
                    VALUES (N'40366ecb-3776-4618-b7a1-74d63d7b3d06', N'admin@gmail.com', 0, N'ADQHRXjqJOnhQ2WX7bnsFaSZ2o1bowb2M8j9ia9sQweDMFEHGjyco4IUiNGtU4e+5g==', N'fe552141-b66d-47ac-80b4-b8306752b4d5', NULL, 0, 0, NULL, 1, 0, N'admin@gmail.com');
                    
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011221655589_SeedAdminUser', N'DesafioFiap.Migrations.Configuration',  0x1F8B0800000000000400DD5C596FE4B8117E0F90FF20E82909BC2D1FF1606274EFC2DB762746C607A6ED45DE066C89DD264622B522E5B111EC2FCBC3FEA4FD0B21758B878E6EF5E1C100034B2C7E552C16C962A9AAFFF8DFEFE39F5E03DF7A811145044FEC93D1B16D41EC120FE1D5C48ED9F2878FF64F3FFEF94FE36B2F78B57EC9E9CE041DEF89E9C47E662CBC701CEA3EC300D05180DC8850B2642397040EF088737A7CFC0FE7E4C4811CC2E6589635FE1C638602983CF0C729C12E0C590CFC5BE2419F66EF79CB3C41B5EE400069085C38B1AF20054B44660884A394DAB62E7D04B82473E82F6D0B604C18605CCE8B270AE72C2278350FF90BE03FBE8590D32D814F6126FF4549DE7528C7A762284ED931877263CA48D013F0E42CD38D23775F4BC376A13BAEBD6BAE65F626469D687062DF783079F599F85C0132C38BA91F09E2897D5BB0B8A4E11D64A3BCE328859C451CEE1B89BE8EAA884756E77E47852D9D8E8EC5BF236B1AFB2C8EE004C39845C03FB21EE2858FDC7FC3B747F215E2C9D9C96279F6F1FC03F0CE3EFC1D9E9D5747CAC7CAE96A2FF8AB87888430E2B2C165317EDB72EAFD1CB963D1ADD227D50AB725BE2C6CEB16BC7E8278C59EF98239FD685B33F40ABDFC4D665C4F18F155C43BB128E68F77B1EF83850F8B76A791A7F8BF81EBE9F98741B8DE8117B44AA65EE2CF174EC4D7D567E827ADF41985E9F2AACDF7978C6C1691403CD7ED2B6DFD322771E48AC11023C923885690D5A51B3BA5F17632690135BC59E7A8876FDA4252D5BCB5A46240EBAC849CC5AE57432EEF76F976B6B8CB30E493979896D04893C1A987D548EA7D6455684AD339E96A3A980FE97BDE09AF0380FC01B6C20E5CB817B24451008B51FE4CB8E101DC5BE6074029DF09BC7F01FADC203AFF7300D1E7D08D236EA073068270EBDC1E9E09867771B01076BF3B5E834DCDE33732032E23D13516BD36C6FB44DCAF2466D7D8BB020C3E313707148F8F28E80E30883897AE0B299D716386DE9470273B07BCC1ECECB4379CD8A0F6ED8A4C7D8002BD2F226DA55F72D2D21FD153283E89814CE7973489FA89AC10EE266A4E6A1635A568153523EB2BAA00EB26694669163421689533A51ACCD34B666878572F813D7C5F6FB3C3DBB41754D438E73B24FC27C430E2DB98F7001883112E67A0CBBEB10F6721993EC174EB6753C2E917E0C743B35A6B35249BC0F0AB21813DFCD59088C95FBF204F78251D2E40393187EF44AFBF5BB5AF3949B25D2F87DA3077CD7C377B40E7E5F2446310217207BF511F8AEDACE7B54DE9FF3E2F6EDBDFFBEF488BBF78BE9F6BE2006C4DC67649297151A23D4D9C358B92D5C5E71706AB3D64968E460EBBF18171DB42C2BFE26FF842B265ABB9C757905B29B42EDD340E3D05D4059EAA453E20AF8760B9FBA611AC0CBFD585FB9BC2939B328C4427206EDC942F0E84996AF708BB28047EAB96A49E1DD78C187BC1436EB98221C48261AB26BA30D747DB8400051F6952DA3434762A16D76C88862B9269CEDBEE4BE5BC2B41B09DD864CB45CD6097D965612B86D9ACB11D1867B34ABA08608C1CEFC340B38B715703906FC98766A0D2F5DC60A099FFBE1303AD6B6C0F065A57C9BB33D0341ED275FEA5E0C8A199673D2AB3FB63BD515D7BB0CD9A3E0ECC3453DF93F761BC078C54F3BC5A8846F8CA34571B2E6776BBA199AB2B9B88009F43568F0F96FEAED60F759A4164236A022C0DAD0534FBE6AC00290BAA877079E0B851BACC8BE8019B07791B61B3BDBF75D4C9F59356EFAF0AACE68E2BC1564C4B15B9FA49BF4268FEF02FDB7CA74B4D31B2C2C894B5D3E90E52C1D1D899BC27D607DE4129A66F0BAA62BAB8D87D9CECCAC0B2C96850508B436C50523E98C1B5945B7CBB96747E5E1F4F6F232D495E99414BF96006D75266A3ED4AD2F81A3DBC8D8D5454F70C065A6C7900A538C48AB6B19366FA652FC68E2125707C0BC210E1552545307B63CDD3FCC0E90FF3FE8973418AE1B854933F57485B706224022B28B572D65CD2198A28BB020C2C80081F4DBD4021D31ED986ED3F67593D95D549CCCF819C5AFC9DF6D044326B47B8EAE36418333EC240384A49385033FFFAEE9648D9043E883411C829F1E3009BFD3673EFF41B74B57FFA4645183B92FC8A5FA6684BF19EEBAAEF3431EAA21868920AB768FD89324398D49D3BB555859B1C5D334A1EF7AAA29862617B9B389323D36BB264D7B3FF5CB5226C675D6551F32A40F6AA2746253F4701ABB47547ADA7505531EB2DDD11A53CA92AA4D4D443CA6A36544DC86AC35A78068DEA29BA7350F39FAAE86A6B77644D2654155AD3BC06B64666B9AD3BAA2659AA0AAC69EE8E5D664EC99BE8019F5CC69BCBDA47577A67DEECEC32606C67471CE6E8ABE4A154812AAF7B626599260A58F6FE20ADC978C35BDB9AD250C966D664C030EF3CB50C8EFAC6D3987662C6ACA565D436F7A6B414335E3F9BDD9BA3A504B036B40C35DAD5DF323A606CE94643941B0DD19F0B43F86E5B9D73E5522F9314DC8BCBBD74891F6717EAF6E23FE5869D92D856BE74B833F746190C46826034FFD59FFA088AA33B27B805182D216569128E7D7A7C722AD50F1E4E2D9F43A9E76B0212A682BEFA9CED209B08BF80C87D06919AD7B541BD5B09AA7CC5B8C11E7C9DD8FF4D7A5D24912BF157F2FAC8BAA14F18FD1AF386C72886D66F6A9EFA30A9641D2ACE0A417F7B17A55CDD557EF39F2F69D723EB3EE2CBE9C23A9614BDCEF4D70BBC7A499376DD409AB5CBBEDEEF6AAB25CB6951A5D5B27E09D502B141CAA77229FF1280D7BFF6154D5B22B511A2A60C6A28BC4154682A735A07CB58E2E4F147969438F51BACBEE4691DD18CE54E08F707938B9DBA6F4379CF3D9E439A4BF22EB6A444CFAD09C31B658EEFFB6C526A4A365AE86ADD480FB8416B43367351DE59CDC56047A7A6A46230EC7DDAFD067514DFC7A6532D5B30B844E75B71B4DA50B75E7470287506E5756ABFE505BBAC2868F8BCFB5D15121C40EAAB26956FFFE502BBB635D3F79803CFB9EE57147060C6963960FB4FFDDFB5B1993ED71CB8B1F54AF03F305BDBD7F9B9674BEB7C84EE3D5D5F4D1194A7559F4E9ECE5DE9096ADDB5F463C8C4F616841B41EA51A625FBFA444D13B3D2588C0C4B1233537386A8CC5859380A5F85A2996DBFB166077EE360339A66B686BCEA26DED9FEDFC83BA369E66DC85696796B6A0414DE1A1A1DEFC32C37D0262BEB2A4B5A36D1A64CCAF7545E501B494B914C9BC3DC98A1F39EAA0906514A6DE91A124DDE4FF1C0202A1972E9F4281650F307F8C15DF98961EE3C50B42A21C40F0E63E8D68EEC82E6062F49EE394812E5245298E71632E0F1F3FC326268095CC69BC57789E437289258AF88042DA07783EF6316C68C0F19060BBF1607151E4813FFA422A22EF3F83E144F748821703191F89E738F7F8E91EF1572CF3401290384706DB2809C984B260273ABB702E98EE08E4099FA0A8FEC1106A1CFC1E83D9E8317B88E6CDCFC3EC11570DFCAC0B009A47D22EA6A1F5F21B08A4040338CB23F7FE436EC05AF3FFE1FC79D0832695B0000 , N'6.4.4')
END

